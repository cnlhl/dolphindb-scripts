login("admin","123456")

def createTB(dbName,tableName){ 
	db=database(directory=dbName);
	if(existsTable(dbName,tableName))
		return
	columns =`Date`stockcode`TransactionTime_3mins`sumVolume
	type=[DATE,SYMBOL,TIME,INT]
	orderData = table(1:0, columns,type)
	db.createPartitionedTable(orderData, tableName,`Date`stockcode)
   }

dbName = "dfs://history"
read_tableName = "testtable"
write_tableName = "groupby3mins"
createTB(dbName, write_tableName)
rtb = loadTable(dbName, read_tableName)
wtb = loadTable(dbName, write_tableName)

Volume = exec Volume from rtb
stockcode = exec stockcode from rtb
Date = exec Date from rtb
TransactionTime = exec TransactionTime from rtb

t = table(Date, stockcode, Volume, TransactionTime)
m = matrix(TABLE, t)
//m.setIndexedMatrix!(')
print(m)

//t.resample("3min",sum)
//select * from t
